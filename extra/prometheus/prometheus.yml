global:
  scrape_interval: '60s'  # Set the global scrape interval (default: 1 minute)
  scrape_timeout:  '60s'  # Timeout must be ≤ scrape_interval

# -----------------------------------------
# Optional: Alertmanager Configuration
# -----------------------------------------
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#             - 'alertmanager:9093'

# -----------------------------------------
# Optional: Prometheus Rule Files
# -----------------------------------------
# rule_files:
#   - 'purefa_alerts_rules.yml'
#   - 'purefa_pods_rules.yml'

# -----------------------------------------
# Prometheus Self-Monitoring
# -----------------------------------------
scrape_configs:

  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

# ==============================================
# FlashArray 1 — arrayname01 (Purity//FA ≥ 6.7.x)
# ==============================================

  # /metrics/array
  - job_name: 'purefa_array_arrayname01'
    metrics_path: '/metrics/array'
    scheme: 'https'
    tls_config:
      insecure_skip_verify: true
    authorization:
      credentials: '11111111-1111-1111-1111-111111111111'
    params:
      namespace: ['purefa']
    static_configs:
      - targets: ['arrayname01.fqdn.com']
        labels:
          instance: 'arrayname01'
          env: 'production'

  # /metrics/volumes
  - job_name: 'purefa_volumes_arrayname01'
    metrics_path: '/metrics/volumes'
    scheme: 'https'
    tls_config:
      insecure_skip_verify: true
    authorization:
      credentials: '11111111-1111-1111-1111-111111111111'
    params:
      namespace: ['purefa']
    static_configs:
      - targets: ['arrayname01.fqdn.com']
        labels:
          instance: 'arrayname01'
          env: 'production'

  # /metrics/hosts
  - job_name: 'purefa_hosts_arrayname01'
    metrics_path: '/metrics/hosts'
    scheme: 'https'
    tls_config:
      insecure_skip_verify: true
    authorization:
      credentials: '11111111-1111-1111-1111-111111111111'
    params:
      namespace: ['purefa']
    static_configs:
      - targets: ['arrayname01.fqdn.com']
        labels:
          instance: 'arrayname01'
          env: 'production'

  # /metrics/pods
  - job_name: 'purefa_pods_arrayname01'
    metrics_path: '/metrics/pods'
    scheme: 'https'
    tls_config:
      insecure_skip_verify: true
    authorization:
      credentials: '11111111-1111-1111-1111-111111111111'
    params:
      namespace: ['purefa']
    static_configs:
      - targets: ['arrayname01.fqdn.com']
        labels:
          instance: 'arrayname01'
          env: 'production'

  # /metrics/directories — Expensive query; scrape less often
  - job_name: 'purefa_directories_arrayname01'
    metrics_path: '/metrics/directories'
    scheme: 'https'
    scrape_interval: '30m'  # Less frequent scraping to reduce load
    scrape_timeout:  '15m'  # Must be shorter than scrape_interval
    tls_config:
      insecure_skip_verify: true
    authorization:
      credentials: '11111111-1111-1111-1111-111111111111'
    params:
      namespace: ['purefa']
    static_configs:
      - targets: ['arrayname01.fqdn.com']
        labels:
          instance: 'arrayname01'
          env: 'production'

# ==============================================
# FlashArray 2 — arrayname02 (Purity//FA ≤ 6.6.x)
# ==============================================

  # /metrics/array
  - job_name: 'purefa_array_arrayname02'
    metrics_path: '/metrics/array'
    authorization:
      credentials: '22222222-2222-2222-2222-222222222222'
    params:
      endpoint: ['arrayname02.fqdn.com']
    static_configs:
      - targets: ['purefa-openmetrics-exporter.fqdn.com:9490']
        labels:
          instance: 'arrayname02'
          env: 'production'

  # /metrics/volumes
  - job_name: 'purefa_volumes_arrayname02'
    metrics_path: '/metrics/volumes'
    authorization:
      credentials: '22222222-2222-2222-2222-222222222222'
    params:
      endpoint: ['arrayname02.fqdn.com']
    static_configs:
      - targets: ['purefa-openmetrics-exporter.fqdn.com:9490']
        labels:
          instance: 'arrayname02'
          env: 'test'

  # /metrics/hosts
  - job_name: 'purefa_hosts_arrayname02'
    metrics_path: '/metrics/hosts'
    authorization:
      credentials: '22222222-2222-2222-2222-222222222222'
    params:
      endpoint: ['arrayname02.fqdn.com']
    static_configs:
      - targets: ['purefa-openmetrics-exporter.fqdn.com:9490']
        labels:
          instance: 'arrayname02'
          env: 'test'

  # /metrics/pods
  - job_name: 'purefa_pods_arrayname02'
    metrics_path: '/metrics/pods'
    authorization:
      credentials: '22222222-2222-2222-2222-222222222222'
    params:
      endpoint: ['arrayname02.fqdn.com']
    static_configs:
      - targets: ['purefa-openmetrics-exporter.fqdn.com:9490']
        labels:
          instance: 'arrayname02'
          env: 'test'

  # /metrics/directories — Expensive query; scrape less often
  - job_name: 'purefa_directories_arrayname02'
    metrics_path: '/metrics/directories'
    scrape_interval: '30m'  # Less frequent scraping to reduce load
    scrape_timeout:  '15m'  # Must be shorter than scrape_interval
    authorization:
      credentials: '22222222-2222-2222-2222-222222222222'
    params:
      endpoint: ['arrayname02.fqdn.com']
    static_configs:
      - targets: ['purefa-openmetrics-exporter.fqdn.com:9490']
        labels:
          instance: 'arrayname02'
          env: 'test'